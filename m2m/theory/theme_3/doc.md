---
layout: page
title: Т3 Подключение микроконтроллеров к беспроводным сетям (Wi-Fi)
---

# Интеграция устройств с протоколами M2M
## Физический уровень

По способу взаимодействия m2m коммуникации делятся на:
- использующие TCP стек
  - Ethernet — классическая проводная сеть, обеспечивающая высокую скорость передачи данных и надёжное соединение. Чаще всего используется в стационарных устройствах или системах, где важна стабильность и минимальные задержки
  - Wi-Fi — беспроводная технология, которая позволяет устройствам подключаться к локальным сетям без использования кабелей. Wi-Fi особенно удобен для динамических систем, где требуется гибкость размещения оборудования
  - Сотовые сети (LTE, LTE-M, NB-IoT) — мобильные решения, которые дают возможность подключать устройства на больших расстояниях и в удалённых локациях. LTE обеспечивает высокую пропускную способность, LTE-M оптимизирован для устройств с низким энергопотреблением, а NB-IoT предназначен для передачи небольших объёмов данных с высокой энергоэффективностью
- задействующие сторонние протоколы
  - ZigBee — протокол для беспроводных сетей с малым радиусом действия, широко применяемый в автоматизации умных домов и промышленных системах
  - Z-Wave — ещё один популярный стандарт для домашних IoT-устройств, обеспечивающий надёжную и энергоэффективную связь между сенсорами и контроллерами
  - Bluetooth Low Energy (BLE) — облегчённая версия Bluetooth, которая позволяет устройствам обмениваться данными на коротких дистанциях с минимальным энергопотреблением, что особенно важно для носимых гаджетов и сенсоров
  - LoRa / LoRaWAN — протоколы дальнего радиуса действия, позволяющие соединять устройства в масштабных сетях IoT, например, для мониторинга городской инфраструктуры, сельского хозяйства или промышленного оборудования. Эти технологии отличаются низким энергопотреблением и способностью работать в труднодоступных местах

Рассмотрим подключение MCU для использования m2m коммуникаций.

![alt text](static/mcu_connection.png)

Для подключения к m2m обязательно наличие компонента, который позволит реализовать интерфейс к среде передаче данных.

В тех случаях, когда для передачи данных используется стандартная сеть TCP/IP, подключение может осуществляться через привычные интерфейсы, такие как Wi-Fi или Ethernet. Для этого применяются соответствующие адаптеры, которые обеспечивают стабильное соединение с локальной или глобальной сетью. Благодаря этим адаптерам устройства получают возможность не только обмениваться данными в реальном времени, но и интегрироваться с более широкими системами, включая облачные платформы, серверные приложения и аналитические сервисы.

Однако M2M-технологии далеко не ограничиваются стандартными протоколами TCP/IP. Для более специализированных решений применяются собственные модули и интерфейсы связи. Такие модули могут использоваться, например, для подключения через сотовые сети (GSM, LTE, 5G), низкоэнергетические протоколы типа LoRaWAN, Zigbee, NB-IoT или другие специфические технологии передачи данных. Каждый из этих модулей оптимизирован под конкретные задачи и позволяет устройствам работать в различных условиях, обеспечивая надёжность, энергосбережение и расширенные возможности управления сетью.

Модули Ethernet и LoRa:

<div style="display: flex; justify-content: space-between; align-items: center;">
  <img src="../static/ethernet_module.png" width="400">
  <img src="../static/lorawan_module.png" width="400">
</div>


## Прикладной уровень

Классические платы Arduino (например, Arduino Uno, Mega) не имеют встроенного Wi-Fi-модуля, поэтому для подключения к беспроводной сети используются внешние модули. Наиболее популярные варианты:
* Wi-Fi Shield для Arduino
* Модули ESP8266 или ESP32, используемые в качестве сетевого сопроцессора
* отдельные модули Wi-Fi

В программной среде Arduino IDE подключение к Wi-Fi обычно реализуется на языке C/C++ с использованием специализированных библиотек (например, WiFi.h). После успешного подключения Arduino может обмениваться данными по TCP/IP, выполнять HTTP-запросы, отправлять данные на сервер или работать с облачными сервисами.

В отличие от классических плат Arduino, ESP32 уже имеет встроенный Wi-Fi (а также Bluetooth), что делает его особенно удобным для IoT-проектов. ESP32 может программироваться как в среде Arduino IDE, так и с использованием альтернативных платформ.

При использовании Arduino framework ESP32 программируется на C/C++, а процесс подключения к Wi-Fi во многом аналогичен Arduino с Wi-Fi-модулем. Разработчик задаёт параметры сети, инициирует соединение и отслеживает его статус.  Такой вариант часто используется в промышленных и коммерческих проектах, где важны производительность и гибкость настройки.

Пример на языке C:

``` C
#include <ESP8266WiFi.h>
#define WIFI_SSID "ssid"
#define WIFI_PASS "pw"
void setup() {
  Serial.begin(115200);
  WiFi.begin(WIFI_SSID, WIFI_PASS);
  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }
  Serial.println("Connected");
  Serial.println(WiFi.localIP());
}
void loop() {
}
```

Альтернативным и всё более популярным вариантом является использование MicroPython — облегчённой версии Python, оптимизированной для микроконтроллеров. В этом случае подключение к Wi-Fi выполняется с помощью высокоуровневых команд, что значительно упрощает разработку и делает код более наглядным.

ESP32 с MicroPython позволяет быстро прототипировать сетевые приложения, управлять подключением к Wi-Fi, выполнять HTTP-запросы и взаимодействовать с облачными API. Такой подход особенно удобен для обучения, экспериментов и быстрого создания прототипов M2M- и IoT-устройств.

Пример на языке MicroPython:

```python
import network

wlan = network.WLAN(network.STA_IF)
wlan.active(True)
wlan.connect(WIFI_SSID, WIFI_PASSWORD)

while not wlan.isconnected():
    time.sleep(1)
```

Использование библиотек для отправки сообщений по TCP, HTTP, MQTT.

# Источники
* [Источник]()
